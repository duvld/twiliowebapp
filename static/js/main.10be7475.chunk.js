(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{168:function(e,a,t){e.exports=t(451)},173:function(e,a,t){},249:function(e,a,t){},451:function(e,a,t){"use strict";t.r(a);var o=t(0),n=t.n(o),i=t(17),c=t.n(i),r=(t(173),t(156)),l=t.n(r),s=(t(249),t(157)),m=t.n(s),d=t(158),h=t.n(d),u=t(84),v=t.n(u),k=t(159),f=t.n(k),p=t(160),b=t(161),y=t(167),R=t(162),T=t(20),E=t(166),g=t(163),w=t.n(g),N=t(164),j=t.n(N),J=t(85),C=t.n(J),O=t(165),P=t.n(O),M=t(86),A=function(e){function a(e){var t;return Object(p.a)(this,a),(t=Object(y.a)(this,Object(R.a)(a).call(this))).state={identity:null,roomName:"",roomNameErr:!1,previewTracks:null,localMediaAvailable:!1,hasJoinedRoom:!1,activeRoom:null},t.joinRoom=t.joinRoom.bind(Object(T.a)(t)),t.handleRoomNameChange=t.handleRoomNameChange.bind(Object(T.a)(t)),t.roomJoined=t.roomJoined.bind(Object(T.a)(t)),t.leaveRoom=t.leaveRoom.bind(Object(T.a)(t)),t.detachTracks=t.detachTracks.bind(Object(T.a)(t)),t.detachParticipantTracks=t.detachParticipantTracks.bind(Object(T.a)(t)),t}return Object(E.a)(a,e),Object(b.a)(a,[{key:"componentDidMount",value:function(){var e=this;j.a.get("/token").then(function(a){var t=a.data,o=t.identity,n=t.token;e.setState({identity:o,token:n})})}},{key:"handleRoomNameChange",value:function(e){var a=e.target.value;this.setState({roomName:a})}},{key:"joinRoom",value:function(){if(this.state.roomName.trim()){console.log("Joining room '"+this.state.roomName+"'...");var e={name:this.state.roomName};this.state.previewTracks&&(e.tracks=this.state.previewTracks),w.a.connect(this.state.token,e).then(this.roomJoined,function(e){alert("Could not connect to Twilio: "+e.message)})}else this.setState({roomNameErr:!0})}},{key:"attachTracks",value:function(e,a){e.forEach(function(e){a.appendChild(e.attach())})}},{key:"attachParticipantTracks",value:function(e,a){var t=Array.from(e.tracks.values());this.attachTracks(t,a)}},{key:"detachTracks",value:function(e){e.forEach(function(e){e.detach().forEach(function(e){e.remove()})})}},{key:"detachParticipantTracks",value:function(e){var a=Array.from(e.tracks.values());this.detachTracks(a)}},{key:"roomJoined",value:function(e){var a=this;console.log("Joined as '"+this.state.identity+"'"),this.setState({activeRoom:e,localMediaAvailable:!0,hasJoinedRoom:!0});var t=this.refs.localMedia;t.querySelector("video")||this.attachParticipantTracks(e.localParticipant,t),e.participants.forEach(function(e){console.log("Already in Room: '"+e.identity+"'");var t=a.refs.remoteMedia;a.attachParticipantTracks(e,t)}),e.on("participantConnected",function(e){console.log("Joining: '"+e.identity+"'")}),e.on("trackAdded",function(e,t){console.log(t.identity+" added track: "+e.kind);var o=a.refs.remoteMedia;a.attachTracks([e],o)}),e.on("trackRemoved",function(e,t){a.log(t.identity+" removed track: "+e.kind),a.detachTracks([e])}),e.on("participantDisconnected",function(e){console.log("Participant '"+e.identity+"' left the room"),a.detachParticipantTracks(e)}),e.on("disconnected",function(){a.state.previewTracks&&a.state.previewTracks.forEach(function(e){e.stop()}),a.detachParticipantTracks(e.localParticipant),e.participants.forEach(a.detachParticipantTracks),a.state.activeRoom=null,a.setState({hasJoinedRoom:!1,localMediaAvailable:!1})})}},{key:"leaveRoom",value:function(){this.state.activeRoom.disconnect(),this.setState({hasJoinedRoom:!1,localMediaAvailable:!1})}},{key:"render",value:function(){var e=this.state.localMediaAvailable?n.a.createElement("div",{className:"flex-item"},n.a.createElement("div",{ref:"localMedia"})," "):"",a=this.state.hasJoinedRoom?n.a.createElement(C.a,{label:"Leave Room",secondary:!0,onClick:this.leaveRoom}):n.a.createElement(C.a,{label:"Join Room",primary:!0,onClick:this.joinRoom});return n.a.createElement(M.Card,null,n.a.createElement(M.CardText,null,n.a.createElement("div",{className:"flex-container"},e," ",n.a.createElement("div",{className:"flex-item"},n.a.createElement(P.a,{hintText:"Room Name",onChange:this.handleRoomNameChange,errorText:this.state.roomNameErr?"Room Name is required":void 0}),n.a.createElement("br",null),a,"  "),n.a.createElement("div",{className:"flex-item",ref:"remoteMedia",id:"remote-media"}))))}}]),a}(o.Component);f()();var x=document.getElementById("app");Object(i.render)(n.a.createElement(m.a,{muiTheme:v()(h.a)},n.a.createElement("div",null,n.a.createElement(l.a,{title:"React Twilio Video"}),n.a.createElement(A,null))),x);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement("app",null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[168,1,2]]]);
//# sourceMappingURL=main.10be7475.chunk.js.map